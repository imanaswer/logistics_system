(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,96086,(e,t,s)=>{t.exports=e.r(9187)},83168,e=>{"use strict";let t="http://localhost:8001";console.log("ğŸ”— Backend API URL:",t),e.s(["API_URL",0,t])},55468,e=>{"use strict";var t=e.i(48277),s=e.i(30668),a=e.i(18033),l=e.i(96086),r=e.i(83168);function d(){let e=(0,l.useRouter)(),[d,n]=(0,s.useState)([]),[i,o]=(0,s.useState)({}),[c,x]=(0,s.useState)([]),[h,m]=(0,s.useState)("ALL"),[p,b]=(0,s.useState)(new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString().split("T")[0]),[u,f]=(0,s.useState)(new Date().toISOString().split("T")[0]),[g,j]=(0,s.useState)(!0);(0,s.useEffect)(()=>{(async()=>{let e=localStorage.getItem("token");if(!e){window.location.href="/login";return}try{let[t,s]=await Promise.all([a.default.get(`${r.API_URL}/api/jobs/`,{headers:{Authorization:`Token ${e}`}}),a.default.get(`${r.API_URL}/api/transactions/`,{headers:{Authorization:`Token ${e}`}})]),l={};t.data.forEach(e=>{l[e.id]=e.client_details?.name||e.client?.name||"Unknown"}),o(l);let d=s.data.sort((e,t)=>new Date(e.date).getTime()-new Date(t.date).getTime());n(d);let i=[...d.map(e=>e.party_name),...Object.values(l)],c=Array.from(new Set(i.map(e=>e?.toUpperCase().trim()))).sort();x(c)}catch(e){console.error(e)}finally{j(!1)}})()},[]);let N=(0,s.useMemo)(()=>{let e=0,t=d;if("ALL"!==h){let e=h.toLowerCase();t=t.filter(t=>(t.party_name||"").toLowerCase().includes(e)||(i[t.job]||"").toLowerCase().includes(e))}return p&&(t=t.filter(e=>e.date>=p)),u&&(t=t.filter(e=>e.date<=u)),t.map(t=>{let s=["CR","BR"].includes(t.trans_type),a=Number(t.amount);return s?e+=a:e-=a,{...t,received:s?a:0,paid:s?0:a,currentBalance:e}})},[h,p,u,d,i]),w=N.reduce((e,t)=>e+t.received,0),v=N.reduce((e,t)=>e+t.paid,0),y=w-v;return g?(0,t.jsx)("div",{className:"p-10 font-black text-center text-slate-400",children:"LOADING REPORTS..."}):(0,t.jsxs)("div",{className:"min-h-screen p-8 bg-slate-50 font-sans text-slate-900",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between max-w-6xl mx-auto mb-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-black tracking-tight text-slate-900",children:"Ledger Statement"}),(0,t.jsx)("p",{className:"font-medium text-slate-500",children:"Real-time running balance and cash flow."})]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("button",{onClick:()=>e.push("/reports/ledger"),className:"px-4 py-2 text-xs font-bold transition bg-blue-600 text-white border rounded-lg shadow-sm hover:bg-blue-700","data-testid":"professional-ledger-button",children:"ğŸ“Š Professional Ledger"}),(0,t.jsx)("button",{onClick:()=>e.push("/"),className:"px-4 py-2 text-xs font-bold transition bg-white border rounded-lg shadow-sm border-slate-300 text-slate-700 hover:bg-slate-50",children:"â† Dashboard"})]})]}),(0,t.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col items-end gap-4 p-5 border bg-white rounded-2xl shadow-sm border-slate-200 md:flex-row",children:[(0,t.jsxs)("div",{className:"flex-1 w-full",children:[(0,t.jsx)("label",{className:"block text-[10px] font-bold text-slate-400 uppercase mb-1",children:"Party Name"}),(0,t.jsxs)("select",{value:h,onChange:e=>m(e.target.value),className:"w-full px-3 py-2.5 rounded-lg border border-slate-200 font-bold text-slate-800 bg-slate-50 outline-none transition focus:bg-white focus:ring-2 focus:ring-blue-500 appearance-none",children:[(0,t.jsx)("option",{value:"ALL",children:"All Clients / Parties"}),c.map((e,s)=>(0,t.jsx)("option",{value:e,children:e},s))]})]}),(0,t.jsxs)("div",{className:"w-full md:w-40",children:[(0,t.jsx)("label",{className:"block text-[10px] font-bold text-slate-400 uppercase mb-1",children:"From"}),(0,t.jsx)("input",{type:"date",value:p,onChange:e=>b(e.target.value),className:"w-full px-3 py-2.5 rounded-lg border border-slate-200 font-bold text-slate-800 bg-slate-50 outline-none"})]}),(0,t.jsxs)("div",{className:"w-full md:w-40",children:[(0,t.jsx)("label",{className:"block text-[10px] font-bold text-slate-400 uppercase mb-1",children:"To"}),(0,t.jsx)("input",{type:"date",value:u,onChange:e=>f(e.target.value),className:"w-full px-3 py-2.5 rounded-lg border border-slate-200 font-bold text-slate-800 bg-slate-50 outline-none"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-3",children:[(0,t.jsxs)("div",{className:"relative flex items-center justify-between p-6 overflow-hidden bg-white border shadow-sm rounded-2xl border-slate-200",children:[(0,t.jsx)("div",{className:"absolute top-0 bottom-0 left-0 w-1 bg-emerald-500"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Total Received"}),(0,t.jsx)("p",{className:"text-3xl font-black text-slate-900",children:w.toFixed(3)})]})]}),(0,t.jsxs)("div",{className:"relative flex items-center justify-between p-6 overflow-hidden bg-white border shadow-sm rounded-2xl border-slate-200",children:[(0,t.jsx)("div",{className:"absolute top-0 bottom-0 left-0 w-1 bg-red-500"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Total Paid"}),(0,t.jsx)("p",{className:"text-3xl font-black text-slate-900",children:v.toFixed(3)})]})]}),(0,t.jsx)("div",{className:"relative flex items-center justify-between p-6 overflow-hidden text-white shadow-lg bg-slate-900 rounded-2xl",children:(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest",children:"Net Cash Position"}),(0,t.jsx)("p",{className:"text-3xl font-black",children:y.toFixed(3)})]})})]}),(0,t.jsx)("div",{className:"overflow-hidden border bg-white rounded-2xl shadow-sm border-slate-200",children:(0,t.jsxs)("table",{className:"w-full text-left border-collapse",children:[(0,t.jsx)("thead",{className:"bg-slate-50 border-b border-slate-200 text-[10px] font-black text-slate-500 uppercase",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"p-4",children:"Date"}),(0,t.jsx)("th",{className:"p-4",children:"Party & Job Info"}),(0,t.jsx)("th",{className:"p-4",children:"Client Name"}),(0,t.jsx)("th",{className:"p-4",children:"Description"}),(0,t.jsx)("th",{className:"p-4 text-right",children:"Received (+)"}),(0,t.jsx)("th",{className:"p-4 text-right text-red-500",children:"Paid (-)"}),(0,t.jsx)("th",{className:"p-4 text-right bg-slate-100 text-slate-900",children:"Running Balance"})]})}),(0,t.jsx)("tbody",{className:"text-sm font-medium divide-y divide-slate-100 text-slate-700",children:0===N.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:7,className:"p-10 text-center text-slate-400",children:"No transactions match your filters."})}):N.map(e=>(0,t.jsxs)("tr",{className:"transition hover:bg-slate-50/80",children:[(0,t.jsx)("td",{className:"p-4 font-bold whitespace-nowrap",children:e.date}),(0,t.jsxs)("td",{className:"p-4",children:[(0,t.jsx)("div",{className:"font-bold text-slate-900",children:e.party_name}),e.job&&(0,t.jsxs)("span",{className:"text-[9px] bg-blue-50 text-blue-600 px-1.5 py-0.5 rounded border border-blue-100 font-bold",children:["JOB #",e.job]})]}),(0,t.jsx)("td",{className:"p-4 font-bold text-slate-900",children:e.client_name||"-"}),(0,t.jsx)("td",{className:"p-4 text-xs text-slate-500 max-w-xs",children:e.description||"-"}),(0,t.jsx)("td",{className:"p-4 font-bold text-right text-green-600",children:e.received>0?e.received.toFixed(3):"-"}),(0,t.jsx)("td",{className:"p-4 font-bold text-right text-red-600",children:e.paid>0?e.paid.toFixed(3):"-"}),(0,t.jsx)("td",{className:`p-4 text-right font-black bg-slate-50/50 ${e.currentBalance>=0?"text-slate-900":"text-red-700"}`,children:e.currentBalance.toFixed(3)})]},e.id))})]})})]})]})}e.s(["default",()=>d])}]);