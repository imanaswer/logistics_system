(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,96086,(e,t,a)=>{t.exports=e.r(9187)},83168,e=>{"use strict";let t="http://localhost:8001";console.log("ðŸ”— Backend API URL:",t),e.s(["API_URL",0,t])},65274,e=>{"use strict";var t=e.i(48277),a=e.i(30668),s=e.i(18033),l=e.i(96086),r=e.i(83168);function n(){let e=(0,l.useRouter)(),n=(0,l.useParams)(),i=n?.jobId||n?.id,[o,c]=(0,a.useState)({client_name:"",client_phone:"",client_email:"",client_address:"",vat_number:"",transport_mode:"SEA",job_date:"",port_loading:"",port_discharge:"",invoice_no:"",supplier_ref:"",truck_details:"",no_of_packages:"0",gross_weight:"0",net_weight:"0",cbm:"0"}),[d,m]=(0,a.useState)(!0),[u,h]=(0,a.useState)(!1);(0,a.useEffect)(()=>{i&&(async()=>{let e=localStorage.getItem("token");if(!e){window.location.href="/login";return}try{let t=(await s.default.get(`${r.API_URL}/api/jobs/${i}/`,{headers:{Authorization:`Token ${e}`}})).data,a=t.shipment_invoice_no||"",l=t.invoice_no||"",n="",o="";if(a.includes("(")){let e=a.split("(");o=e.slice(1).join("(").replace(/\)$/,""),a=e[0].trim()}else a.match(/(\d+x|ft|ton)/i)&&(o=a,a="");if(a.includes("||")){let e=a.split("||");l||(l=e[0].trim()),n=e[1].trim()}else!l&&a&&(n=a);c({client_name:t.client_details?.name||t.client?.name||"",client_phone:t.client_details?.phone||t.client?.phone||"",client_email:t.client_details?.email||t.client?.email||"",client_address:t.client_details?.address||t.client?.address||"",vat_number:t.vat_number||"",transport_mode:t.transport_mode||"SEA",job_date:t.job_date||"",port_loading:t.port_loading||"",port_discharge:t.port_discharge||"",invoice_no:l,supplier_ref:n,truck_details:o,no_of_packages:t.no_of_packages?.toString()||"0",gross_weight:t.gross_weight?.toString()||"0",net_weight:t.net_weight?.toString()||"0",cbm:t.cbm?.toString()||"0"}),m(!1)}catch(e){console.error("Error fetching job:",e),m(!1)}})()},[i]);let p=async t=>{t.preventDefault(),h(!0);let a=localStorage.getItem("token"),l=o.truck_details?` (${o.truck_details})`:"",n=o.invoice_no.trim(),c=o.supplier_ref.trim(),d=`${n} || ${c}${l}`,m={vat_number:o.vat_number,invoice_no:n,client:{name:o.client_name,phone:o.client_phone,email:o.client_email,address:o.client_address,vat_number:o.vat_number},transport_mode:o.transport_mode,job_date:o.job_date,port_loading:o.port_loading,port_discharge:o.port_discharge,shipment_invoice_no:d,no_of_packages:parseFloat(o.no_of_packages)||0,gross_weight:parseFloat(o.gross_weight)||0,net_weight:parseFloat(o.net_weight)||0,cbm:parseFloat(o.cbm)||0};try{await s.default.put(`${r.API_URL}/api/jobs/${i}/`,m,{headers:{Authorization:`Token ${a}`}}),alert("âœ… Job Updated Successfully!"),e.push(`/jobs/${i}/view`)}catch(e){if(console.error("Save failed",e),h(!1),e.response&&e.response.data){let t=e.response.data;t.invoice_no?alert(`âŒ Error: Invoice Number is too long. Server limit is 100 (or you haven't migrated DB to 1000).`):t.shipment_invoice_no?alert(`âŒ Error: Combined text is too long.

PLEASE RUN MIGRATIONS:
1. python manage.py makemigrations
2. python manage.py migrate`):alert(`Server Error:
${JSON.stringify(t,null,2)}`)}else alert("Network Error: Could not reach server.")}};if(d)return(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center font-bold text-slate-400",children:"LOADING..."});let g="bg-white p-8 rounded-2xl border border-slate-200 shadow-sm space-y-6",x="block text-xs font-bold text-slate-500 uppercase tracking-wide mb-1.5",b="w-full p-3 rounded-lg border border-slate-200 font-bold text-slate-900 bg-slate-50 focus:bg-white focus:ring-2 focus:ring-blue-500 focus:border-transparent outline-none transition";return(0,t.jsx)("div",{className:"min-h-screen bg-slate-50 p-6 flex justify-center font-sans",children:(0,t.jsxs)("div",{className:"w-full max-w-4xl space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center bg-white p-6 rounded-2xl shadow-sm border border-slate-200",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-black text-slate-900 tracking-tight",children:"Edit Job Details"}),(0,t.jsx)("p",{className:"text-sm text-slate-500 font-medium mt-1",children:"Update customer info or shipment details."})]}),(0,t.jsx)("button",{onClick:()=>e.push("/"),className:"text-slate-500 hover:text-red-600 font-bold text-sm bg-slate-100 hover:bg-red-50 px-4 py-2 rounded-lg transition",children:"Cancel"})]}),(0,t.jsxs)("form",{onSubmit:p,className:"space-y-6",children:[(0,t.jsxs)("div",{className:g,children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-slate-900 border-b pb-4",children:"Customer Information"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:x,children:"Customer Name"}),(0,t.jsx)("input",{type:"text",value:o.client_name,onChange:e=>c({...o,client_name:e.target.value}),className:b})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:x,children:"VAT Number"}),(0,t.jsx)("input",{type:"text",value:o.vat_number,onChange:e=>c({...o,vat_number:e.target.value}),className:b})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:x,children:"Phone"}),(0,t.jsx)("input",{type:"text",value:o.client_phone,onChange:e=>c({...o,client_phone:e.target.value}),className:b})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:x,children:"Email"}),(0,t.jsx)("input",{type:"email",value:o.client_email,onChange:e=>c({...o,client_email:e.target.value}),className:b})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:x,children:"Address"}),(0,t.jsx)("textarea",{value:o.client_address,onChange:e=>c({...o,client_address:e.target.value}),className:b,rows:2})]})]})]}),(0,t.jsxs)("div",{className:g,children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-slate-900 border-b pb-4",children:"Shipment Details"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:x,children:"Transport Mode"}),(0,t.jsxs)("select",{value:o.transport_mode,onChange:e=>c({...o,transport_mode:e.target.value}),className:b,children:[(0,t.jsx)("option",{value:"SEA",children:"Sea Freight"}),(0,t.jsx)("option",{value:"AIR",children:"Air Freight"}),(0,t.jsx)("option",{value:"LAND",children:"Land Freight"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:x,children:"Job Date"}),(0,t.jsx)("input",{type:"date",value:o.job_date,onChange:e=>c({...o,job_date:e.target.value}),className:b})]}),(0,t.jsxs)("div",{className:"md:col-span-2 bg-blue-50 p-5 rounded-xl border border-blue-100",children:[(0,t.jsx)("label",{className:x,children:"Add Container / Vehicle"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mb-3",children:["1x20 ft dry","1x40 ft dry","1x20 ft reefer","1x40 ft reefer","3 ton reefer","3 ton normal","10 ton reefer","10 ton normal"].map(e=>(0,t.jsxs)("button",{type:"button",onClick:()=>{let t,a;return t=o.truck_details||"",a=e.replace("1x ",""),void(t.includes(a)?t+=`, 1x ${a}`:t=t?`${t}, 1x ${a}`:`1x ${a}`,c({...o,truck_details:t}))},className:"bg-white border border-blue-200 text-blue-800 px-3 py-2 text-[10px] font-bold uppercase rounded-lg hover:bg-blue-600 hover:text-white transition shadow-sm",children:["+ ",e.replace("1x ","")]},e))}),(0,t.jsx)("label",{className:x,children:"Selected List (Editable)"}),(0,t.jsx)("input",{type:"text",value:o.truck_details,onChange:e=>c({...o,truck_details:e.target.value}),className:"w-full p-3 rounded-lg border border-blue-200 font-bold text-blue-900 bg-white focus:outline-none"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:x,children:"Origin"}),(0,t.jsx)("input",{type:"text",value:o.port_loading,onChange:e=>c({...o,port_loading:e.target.value}),className:b})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:x,children:"Destination"}),(0,t.jsx)("input",{type:"text",value:o.port_discharge,onChange:e=>c({...o,port_discharge:e.target.value}),className:b})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:x,children:"Invoice Number"}),(0,t.jsx)("input",{type:"text",value:o.invoice_no,onChange:e=>c({...o,invoice_no:e.target.value}),className:b})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:x,children:"Supplier Reference"}),(0,t.jsx)("input",{type:"text",value:o.supplier_ref,onChange:e=>c({...o,supplier_ref:e.target.value}),className:b})]})]}),(0,t.jsxs)("div",{className:"pt-4 border-t border-slate-100 grid grid-cols-2 md:grid-cols-4 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:x,children:"Packages"}),(0,t.jsx)("input",{type:"number",value:o.no_of_packages,onChange:e=>c({...o,no_of_packages:e.target.value}),className:b})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:x,children:"Gross Wt"}),(0,t.jsx)("input",{type:"number",value:o.gross_weight,onChange:e=>c({...o,gross_weight:e.target.value}),className:b})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:x,children:"Net Wt"}),(0,t.jsx)("input",{type:"number",value:o.net_weight,onChange:e=>c({...o,net_weight:e.target.value}),className:b})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:x,children:"Volume"}),(0,t.jsx)("input",{type:"number",value:o.cbm,onChange:e=>c({...o,cbm:e.target.value}),className:b})]})]})]}),(0,t.jsx)("div",{className:"flex justify-end pt-2",children:(0,t.jsx)("button",{type:"submit",disabled:u,className:"bg-slate-900 text-white font-bold py-4 px-12 rounded-xl shadow-lg hover:bg-black transition w-full md:w-auto",children:u?"Saving...":"Save Changes"})})]})]})})}e.s(["default",()=>n])}]);